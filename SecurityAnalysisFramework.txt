Informal Security Analysis of Proposed Framework

1)	Anonymity and Unlinkability
The following security analysis assumes than an attacker can intercept, receive, and transmit communication on the wireless traffic between an IoT device with id(device) and the home gateway (HG). I will propose problems that could occur, as previously suggested, and discuss the ways in which our proposed framework has been designed to deal with them. The attacker wants to spoof the identity of device with id(device), however, in the proposed framework when a device wants to connect to the HG, it sends a temporary CIDi rather than sending the id(device) in plaintext. This should prevent an attacker from duplicating the identity as an identity cannot be obtained unless one of the genuinely authenticated devices is communicating. Only a legitimate HG can detect the identification of the device by decrypting C1 using ETk(id(gateway)$|$$|$id(device)$|$$|$N$|$$|$T1). The proposed framework therefore allows for anonymity between the device and the HG. This goes \_ ways to achieving the objectives of the dissertation.\\
Similarly, the proposed framework achieves unlinkability. If an attacker attempts to trace whether an authenticated device has previously requested connection to the HG, they will not be able to link an attempt successfully in the framework. For example, for each session, the device computes the authentic message C1, V1, CIDi, T2. These messages are always different and, therefore, a pattern should not be discernible from intercepted communication. The message is randomly generated by the random number Ra and contains the current timestamp for the transaction. It should subsequently be near impossible to link two differentiating value instances. As a result, the framework achieves unlinkability. It must be noted, however, that unlinkability may be broken if an attacker has access to a malicious HG (such that it is compromised by the adversary). However, from Bi = Hash(X$|$$|$Y) XOR Ai it may still not be possible to derive the deviceâ€™s identity because Ai is encrypted with key K = Hash(Y$|$$|$Hash(id(gateway)$|$$|$Hash(X))$|$$|$Ua).\\

2)	Mutual Authentication
Mutual authentication is an important properly for a verification service attempting to prevent unauthorised access. The proposed framework provides a mutual authentication for the communicating devices. The HG authenticates any device by means of id(device), N (corresponding to number of installation attempts), from Ai = Encryptionk(id(device),N). Additional checks are performed by comparing id(device) = id(device). The integrity of the messages can also be upheld using one-way hash functions that significantly secure message contents.\\

3)	Prevention of Replay Attacks
The proposed framework allows for the prevention of replay attacks, as discussed in objective _ of the dissertation. Throughout the later stages of the key establishment between the HG and the device, time stamps are utilised to check that message transactions occur when they say they should be occurring. For example, the HG and device decide on a time latency that can be calculated from a newly derived timestamp, compared with one obtained from a previous security transaction. Once one has been subtracted from the other, the authenticity of the transaction can be confirmed. If an attacker attempts to intercept valid message C1, B1, CIDi, T2 and attempts to start a session with the HG by replaying the same message, the verification checks within the message should cause the system to fail due to the implementation of the time delay \_. The same occurs throughout each stage of the message key establishment phase.\\

4)	Prevention of Impersonation Attacks
Similarly, to the previous security analysis, impersonation attacks should be prevented with timestamped messages and comparison of these for the purpose of disclosing time latency between transactions. Moreover, since the key K = Hash(Y$|$$|$Hash(id(gateway)$|$$|$Hash(device))$|$$|$Ua) is computed using the unique authentication token Ua, an attacker cannot impersonate the device by forging a correct message. The attack must also know the secret token used to generate the message C2 which is encrypted using the symmetric key SK = Hash(Ra$|$$|$Rhg$|$$|$id(device)$|$$|$id(gateway)$|$$|$Ua). Therefore, the proposed framework also protects against impersonation attempts as discussed in objective \_ of the dissertation.\\

5)	Prevention of Man-in-the-Middle
Man-in-the-Middle (MITM) attacks assume that an adversary can intercept communication and attempt to modify messages in such a way that changes their parameters. The framework protects against these as the HG should detect any attempts for false parameters when the likes of Ai are decrypted using K = Hash(Y$|$$|$Hash(id(gateway)$|$$|$Hash(X))$|$$|$Ua) and the contents are compared for to authenticate the transaction. The framework, therefore, protects against MITM attempts as discussed in objective \_ of the dissertation.\\  

6)	Secure Session Key Agreement
The last check of our security analysis will be for securing session key agreements. This assures that the secret key generated throughout the framework holds and cannot be derived by an adversary for the purpose of illegitimate transactions across the IoT network. It can be seen throughout the proposed framework that after performing mutual authentication between a device and the HG, the session key Sk = Hash(Ra$|$$|$Rhg$|$$|$id(device)$|$$|$id(gateway)$|$$|$Ua) is generated using timestamps and pseudo-random numbers to provide unique transactions at each level. The messages that are send and receive are typically computed using said random numbers Ra and Rhg, which causes the changes transactions to be regarded as dynamic variables. These variables ensure that there is no long-term compromise from an adversary on the network by ensuring transactions are always differentiating. Even if an attacker were able to derive key K, for example, they would not be able to discern transaction contents due to the use of Ra and Rhg. As a result, our framework also ensures secure session key agreement, as discussed in objective \_ of the dissertation.\\
